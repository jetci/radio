# J Radio - ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤ (Development Guide)

> **Interactive 3D Globe Radio Application**  
> ‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏ü‡∏±‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏‡∏™‡∏î‡∏à‡∏≤‡∏Å‡∏ó‡∏±‡πà‡∏ß‡πÇ‡∏•‡∏Å‡∏ú‡πà‡∏≤‡∏ô 3D Globe ‡∏û‡∏£‡πâ‡∏≠‡∏° AI Recommendations

---

## üö® ‡∏Å‡∏é‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (Communication Rules)

‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô ‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢ AI **‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏Ñ‡∏£‡πà‡∏á‡∏Ñ‡∏£‡∏±‡∏î**:

1.  **‡∏†‡∏≤‡∏©‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£**: ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ **‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢** ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏ï‡πâ‡∏ï‡∏≠‡∏ö ‡∏™‡∏ô‡∏ó‡∏ô‡∏≤ ‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏ó‡∏±‡∏ö‡∏®‡∏±‡∏û‡∏ó‡πå‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡πÑ‡∏î‡πâ)
2.  **‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ**: ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏ï‡πà‡∏≠ ‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢

---

## üìö ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç

1. [‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå](#‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå)
2. [‡πÅ‡∏´‡∏•‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç](#‡πÅ‡∏´‡∏•‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç)
3. [‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå](#‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå)
4. [Tech Stack](#tech-stack)
5. [‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå](#‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå)
6. [Radio Browser API](#radio-browser-api)
7. [Gemini AI Integration](#gemini-ai-integration)
8. [Component Architecture](#component-architecture)
9. [State Management](#state-management)
10. [Styling Guidelines](#styling-guidelines)
11. [Error Handling](#error-handling)
12. [Performance Optimization](#performance-optimization)
13. [Testing Guidelines](#testing-guidelines)
14. [Deployment](#deployment)
15. [Troubleshooting](#troubleshooting)

---

## üéØ ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå

**J Radio** ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÅ‡∏•‡∏∞‡∏ü‡∏±‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏‡∏à‡∏≤‡∏Å‡∏ó‡∏±‡πà‡∏ß‡πÇ‡∏•‡∏Å‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• 3D Globe ‡πÅ‡∏ö‡∏ö Interactive

### ‚ú® Features ‡∏´‡∏•‡∏±‡∏Å

- üåç **3D Globe Visualization** - ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏‡∏ö‡∏ô‡πÇ‡∏•‡∏Å 3 ‡∏°‡∏¥‡∏ï‡∏¥
- üìª **Live Radio Streaming** - ‡πÄ‡∏•‡πà‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏‡∏™‡∏î‡∏à‡∏≤‡∏Å 30,000+ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ó‡∏±‡πà‡∏ß‡πÇ‡∏•‡∏Å
- ü§ñ **AI-Powered Recommendations** - ‡πÉ‡∏ä‡πâ Gemini AI ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ï‡∏≤‡∏° mood
- üîç **Advanced Search** - ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠, ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®, ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó, ‡πÅ‡∏•‡∏∞‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
- ‚≠ê **Favorites System** - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
- üé® **Modern UI/UX** - Glassmorphism, Neon Accents, Responsive Design
- üåê **Geolocation Support** - ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ

---

## üîó ‡πÅ‡∏´‡∏•‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç

### Radio Browser API

#### üìñ Official Resources

| Resource | URL | Description |
|----------|-----|-------------|
| **Official Website** | https://www.radio-browser.info/ | ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á Radio Browser |
| **User Documentation** | https://www.radio-browser.info/users | ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ |
| **Interactive Map** | https://www.radio-browser.info/map | ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏‡∏ó‡∏±‡πà‡∏ß‡πÇ‡∏•‡∏Å |
| **GitLab Repository** | https://gitlab.com/radiobrowser/radio-database | Source code ‡πÅ‡∏•‡∏∞ documentation |
| **API Documentation** | https://api.radio-browser.info/ | API Endpoints ‡πÅ‡∏•‡∏∞ Examples |

#### üîë Key Information

- **Database**: Open-source community radio station database
- **Total Stations**: 30,000+ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏∏‡∏ó‡∏±‡πà‡∏ß‡πÇ‡∏•‡∏Å
- **Update Frequency**: Real-time updates from community
- **API Access**: Free, no authentication required
- **Rate Limits**: None (but please be respectful)
- **Data Format**: JSON
- **CORS**: Enabled for browser access

#### üåê API Mirrors

```javascript
const MIRRORS = [
  'https://de1.api.radio-browser.info/json',  // Germany
  'https://at1.api.radio-browser.info/json',  // Austria
  'https://nl1.api.radio-browser.info/json'   // Netherlands
];
```

**Note**: ‡πÉ‡∏ä‡πâ mirror fallback ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£ (implemented in `radioApi.ts`)

---

## üìÅ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå

```
d:\j-radio/
‚îú‚îÄ‚îÄ üìÑ Configuration Files
‚îÇ   ‚îú‚îÄ‚îÄ package.json              # Dependencies ‡πÅ‡∏•‡∏∞ Scripts
‚îÇ   ‚îú‚îÄ‚îÄ tsconfig.json             # TypeScript Configuration
‚îÇ   ‚îú‚îÄ‚îÄ vite.config.ts            # Vite Build Configuration
‚îÇ   ‚îú‚îÄ‚îÄ .env.local                # Environment Variables (GEMINI_API_KEY)
‚îÇ   ‚îú‚îÄ‚îÄ metadata.json             # App Metadata (AI Studio)
‚îÇ   ‚îî‚îÄ‚îÄ .gitignore                # Git Ignore Rules
‚îÇ
‚îú‚îÄ‚îÄ üìÑ Entry Points
‚îÇ   ‚îú‚îÄ‚îÄ index.html                # HTML Entry Point
‚îÇ   ‚îú‚îÄ‚îÄ index.tsx                 # React Entry Point
‚îÇ   ‚îî‚îÄ‚îÄ index.css                 # Global Styles
‚îÇ
‚îú‚îÄ‚îÄ üìÑ Core Application
‚îÇ   ‚îú‚îÄ‚îÄ App.tsx                   # Main Application Component
‚îÇ   ‚îú‚îÄ‚îÄ types.ts                  # TypeScript Type Definitions
‚îÇ   ‚îî‚îÄ‚îÄ contexts/                 # Global State (Language, Theme)
‚îÇ
‚îú‚îÄ‚îÄ üìÅ components/                # React Components
‚îÇ   ‚îú‚îÄ‚îÄ GlobeView.tsx             # 3D Globe Visualization
‚îÇ   ‚îú‚îÄ‚îÄ Sidebar.tsx               # Search & Filter Panel
‚îÇ   ‚îî‚îÄ‚îÄ AudioPlayer.tsx           # Audio Playback Controls
‚îÇ
‚îú‚îÄ‚îÄ üìÅ hooks/                     # Custom React Hooks
‚îÇ   ‚îú‚îÄ‚îÄ useListeningHistory.ts    # History Management
‚îÇ   ‚îî‚îÄ‚îÄ useToast.ts               # Notification System
‚îÇ
‚îú‚îÄ‚îÄ üìÅ services/ & api/           # External Services
‚îÇ   ‚îú‚îÄ‚îÄ services/radioApi.ts      # Radio Browser API Client
‚îÇ   ‚îú‚îÄ‚îÄ services/geminiService.ts # Gemini AI Service
‚îÇ   ‚îî‚îÄ‚îÄ api/gemini.ts             # Gemini API Handlers
‚îÇ
‚îú‚îÄ‚îÄ üìÅ utils/                     # Utility Functions
‚îÇ   ‚îú‚îÄ‚îÄ cityCluster.ts            # Logic ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏∑‡∏≠‡∏á
‚îÇ   ‚îú‚îÄ‚îÄ spreadPoints.ts           # Logic ‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏à‡∏∏‡∏î‡∏ö‡∏ô‡πÇ‡∏•‡∏Å
‚îÇ   ‚îî‚îÄ‚îÄ countryCoordinates.ts     # ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®
‚îÇ
‚îî‚îÄ‚îÄ üìÅ .agent/                    # Development Documentation
    ‚îî‚îÄ‚îÄ DEVELOPMENT_GUIDE.md      # This file
```

---

## üõ†Ô∏è Tech Stack

### Frontend Framework
- **React** `19.2.3` - UI Library
- **TypeScript** `5.8.2` - Type Safety
- **Vite** `6.2.0` - Build Tool & Dev Server

### 3D Visualization
- **react-globe.gl** `2.37.0` - 3D Globe Component
- **Three.js** `0.170.0` - WebGL 3D Library

### Styling
- **Tailwind CSS** (via CDN) - Utility-first CSS
- **Google Fonts (Inter)** - Typography

### APIs & Services
- **Radio Browser API** - Radio Station Database
- **Google Gemini AI** `@google/genai 1.38.0` - AI Recommendations

### UI Components
- **lucide-react** `0.563.0` - Icon Library

### Development Tools
- **@vitejs/plugin-react** `5.0.0` - React Fast Refresh
- **@types/node** `22.14.0` - Node.js Type Definitions

---

## üöÄ ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå

### Prerequisites

- **Node.js** >= 18.0.0
- **npm** >= 9.0.0
- **Gemini API Key** (Get from [Google AI Studio](https://ai.google.dev/))

### Installation Steps

```bash
# 1. Clone repository (if applicable)
git clone <repository-url>
cd j-radio

# 2. Install dependencies
npm install

# 3. Set up environment variables
# Create .env.local file
echo "GEMINI_API_KEY=your_api_key_here" > .env.local

# 4. Start development server
npm run dev
```

### Available Scripts

```bash
npm run dev      # Start development server (http://localhost:5173)
npm run build    # Build for production
npm run preview  # Preview production build
```

### Environment Variables

Create `.env.local` file in root directory:

```env
# Required
GEMINI_API_KEY=your_gemini_api_key_here

# Optional (for future features)
# RADIO_BROWSER_USER_AGENT=YourAppName/1.0
```

---

## üì° Radio Browser API

### API Base URLs

```typescript
const API_MIRRORS = [
  'https://de1.api.radio-browser.info/json',
  'https://at1.api.radio-browser.info/json',
  'https://nl1.api.radio-browser.info/json'
];
```

### Main Endpoints Used

#### 1. Get Top Voted Stations

```typescript
GET /stations/search?order=votes&reverse=true&limit=2500&has_geo=true&hidebroken=true
```

**Parameters:**
- `order=votes` - ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÇ‡∏´‡∏ß‡∏ï
- `reverse=true` - ‡∏°‡∏≤‡∏Å‡πÑ‡∏õ‡∏ô‡πâ‡∏≠‡∏¢
- `limit=2500` - ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î
- `has_geo=true` - ‡∏°‡∏µ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏†‡∏π‡∏°‡∏¥‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
- `hidebroken=true` - ‡∏ã‡πà‡∏≠‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ

#### 2. Search by Country

```typescript
GET /stations/search?countrycode={CODE}&order=votes&reverse=true&limit=100&hidebroken=true
```

**Example:**
```typescript
radioApi.getStationsByCountry('TH', 100); // Thailand stations
```

#### 3. Advanced Search

```typescript
GET /stations/search?{params}
```

**Supported Parameters:**
- `name` - ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ
- `country` - ‡∏ä‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®
- `countrycode` - ‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏® (ISO 3166-1)
- `tag` - ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó/‡πÅ‡∏ó‡πá‡∏Å (jazz, rock, news, etc.)
- `limit` - ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
- `has_geo` - ‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏û‡∏¥‡∏Å‡∏±‡∏î
- `hidebroken` - ‡∏ã‡πà‡∏≠‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡πÄ‡∏™‡∏µ‡∏¢

### Response Format

```typescript
interface Station {
  changeuuid: string;
  stationuuid: string;
  name: string;
  url: string;
  url_resolved: string;
  homepage: string;
  favicon: string;
  tags: string;
  country: string;
  countrycode: string;
  state: string;
  language: string;
  votes: number;
  clickcount: number;
  codec: string;
  bitrate: number;
  geo_lat: number | null;
  geo_long: number | null;
  is_approximate?: boolean;
}
```

### Error Handling

```typescript
async function fetchWithFallback(path: string) {
  let lastError;
  for (let i = 0; i < MIRRORS.length; i++) {
    try {
      const response = await fetch(`${mirror}${path}`, {
        headers: { 
          'Accept': 'application/json',
          'User-Agent': 'J-Radio/1.0'
        }
      });
      if (!response.ok) throw new Error(`HTTP ${response.status}`);
      return await response.json();
    } catch (error) {
      lastError = error;
      // Try next mirror
    }
  }
  throw lastError;
}
```

### Best Practices

1. **Use Mirror Fallback** - ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£
2. **Set User-Agent** - ‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏≠‡∏õ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
3. **Cache Results** - ‡∏•‡∏î API calls
4. **Filter by has_geo** - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏ô Globe
5. **Handle Broken Streams** - ‡πÉ‡∏ä‡πâ `hidebroken=true`

---

## ü§ñ Gemini AI Integration

### Setup

```typescript
import { GoogleGenAI, Type } from "@google/genai";

const ai = new GoogleGenAI({ 
  apiKey: process.env.API_KEY 
});
```

### AI Recommendation Flow

```typescript
async function getAiRecommendations(userInput: string) {
  const response = await ai.models.generateContent({
    model: 'gemini-3-flash-preview',
    contents: `The user is looking for radio stations. 
               Input: "${userInput}". 
               Analyze the mood or intent and provide exactly 3 
               specific radio tags or genres that would best match.`,
    config: {
      responseMimeType: "application/json",
      responseSchema: {
        type: Type.ARRAY,
        items: { type: Type.STRING }
      }
    }
  });

  return JSON.parse(response.text || '[]');
}
```

### Example Usage

**Input:**
```typescript
getAiRecommendations("I want to relax after work")
```

**Output:**
```json
["lofi", "jazz", "ambient"]
```

### Use Cases

1. **Mood-based Search** - "I'm feeling energetic"
2. **Activity-based** - "Music for studying"
3. **Time-based** - "Morning coffee music"
4. **Genre Discovery** - "Something like jazz but modern"

---

## üß© Component Architecture

### 1. App.tsx (Main Controller)

**Responsibilities:**
- Global state management
- API orchestration
- Component coordination
- Audio playback control

**Key State:**

```typescript
const [stations, setStations] = useState<Station[]>([]);
const [activeStation, setActiveStation] = useState<Station | null>(null);
const [isPlaying, setIsPlaying] = useState(false);
const [favorites, setFavorites] = useState<Station[]>([]);
const [volume, setVolume] = useState(0.7);
const [filters, setFilters] = useState<SearchParams>({});
```

**Key Functions:**

```typescript
handleStart() // Initialize app
toggleFavorite(station) // Manage favorites
handleFilterChange(params) // Update search filters
handleStationSelect(station) // Select and play station
```

---

### 2. GlobeView.tsx (3D Visualization)

**Props:**
```typescript
interface GlobeViewProps {
  stations: Station[];
  onSelectStation: (station: Station) => void;
  activeStation: Station | null;
}
```

**Features:**
- Interactive 3D Earth
- Station markers with geo-coordinates
- Hover tooltips
- Click to select
- Auto-focus on active station
- Ring animation for playing station

**Key Implementation:**

```typescript
// Point Data Mapping
const pointData = stations.map(s => ({
  ...s,
  lat: s.geo_lat!,
  lng: s.geo_long!,
  size: isSelected ? 0.6 : 0.18,
  color: isSelected ? '#ffffff' : '#00ff41'
}));

// Ring Animation for Active Station
const ringData = activeStation ? [{
  lat: activeStation.geo_lat,
  lng: activeStation.geo_long,
  maxR: 5,
  propagationSpeed: 1.5,
  repeatPeriod: 800
}] : [];
```

---

### 3. Sidebar.tsx (Search & Filter)

**Props:**
```typescript
interface SidebarProps {
  onSelectStation: (station: Station) => void;
  favorites: Station[];
  onToggleFavorite: (station: Station) => void;
  stations: Station[];
  onFilterChange: (params: SearchParams) => void;
  isOpen: boolean;
  setIsOpen: (open: boolean) => void;
  onAutoTune?: () => void;
}
```

**Features:**
- Text search
- AI-powered search
- Quick tag filters
- Favorites list
- Country filter
- Responsive drawer

**Search Implementation:**

```typescript
// Text Search
const handleSearch = (e: React.FormEvent) => {
  e.preventDefault();
  onFilterChange({ name: searchQuery });
};

// AI Search
const handleAiSearch = async () => {
  const tags = await geminiService.getAiRecommendations(aiQuery);
  if (tags.length > 0) {
    onFilterChange({ tag: tags[0] });
  }
};
```

---

### 4. AudioPlayer.tsx (Playback Control)

**Props:**
```typescript
interface AudioPlayerProps {
  station: Station | null;
  isPlaying: boolean;
  volume: number;
  onTogglePlay: () => void;
  onVolumeChange: (val: number) => void;
  onExploreClick: () => void;
  isFavorite: boolean;
  onToggleFavorite: () => void;
}
```

**Features:**
- Play/Pause control
- Volume control
- Waveform visualizer
- Error handling (CORS, 404, Network)
- Loading states
- Station info display

**Audio Management:**

```typescript
useEffect(() => {
  if (station && audioRef.current) {
    let streamUrl = station.url_resolved || station.url;
    
    // HTTPS upgrade for security
    if (window.location.protocol === 'https:' && 
        streamUrl.startsWith('http:')) {
      streamUrl = streamUrl.replace('http:', 'https:');
    }
    
    audioRef.current.src = streamUrl;
    audioRef.current.load();
    
    if (isPlaying) {
      audioRef.current.play().catch(handleError);
    }
  }
}, [station?.stationuuid]);
```

---

## üîÑ State Management

### Local Storage

**Favorites Persistence:**

```typescript
// Save favorites
useEffect(() => {
  localStorage.setItem('j-radio-favorites', 
    JSON.stringify(favorites)
  );
}, [favorites]);

// Load favorites
useEffect(() => {
  const saved = localStorage.getItem('j-radio-favorites');
  if (saved) {
    setFavorites(JSON.parse(saved));
  }
}, []);
```

### State Flow

```
User Action
    ‚Üì
Component Event Handler
    ‚Üì
App.tsx State Update
    ‚Üì
Props to Child Components
    ‚Üì
UI Re-render
```

---

## üé® Styling Guidelines

### Color Palette

```css
/* Primary Colors */
--bg-primary: #020617;      /* Dark Blue */
--bg-secondary: #030712;    /* Darker Blue */

/* Accent Colors */
--accent-neon: #00ff41;     /* Neon Green */
--accent-live: #ef4444;     /* Red (Live) */
--accent-error: #ff5722;    /* Orange (Error) */

/* Text Colors */
--text-primary: #ffffff;
--text-secondary: rgba(255, 255, 255, 0.7);
--text-muted: rgba(255, 255, 255, 0.4);
```

### Typography

```css
font-family: 'Inter', sans-serif;

/* Font Weights */
--font-light: 300;
--font-regular: 400;
--font-medium: 500;
--font-semibold: 600;
--font-bold: 700;
```

### Design Patterns

1. **Glassmorphism**
```css
background: rgba(0, 0, 0, 0.8);
backdrop-filter: blur(20px);
border: 1px solid rgba(255, 255, 255, 0.1);
```

2. **Pill Shapes**
```css
border-radius: 9999px; /* Full rounded */
```

3. **Neon Accents**
```css
color: #00ff41;
text-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
```

4. **Smooth Transitions**
```css
transition: all 0.3s ease;
```

---

## ‚ö†Ô∏è Error Handling

### Audio Stream Errors

```typescript
const handleAudioError = (e: any) => {
  const code = e.target.error?.code;
  
  switch(code) {
    case 4: // MEDIA_ERR_SRC_NOT_SUPPORTED
      setErrorType('cors');
      break;
    case 2: // MEDIA_ERR_NETWORK
      setErrorType('network');
      break;
    default:
      setErrorType('unknown');
  }
};
```

### API Error Handling

```typescript
try {
  const stations = await radioApi.searchStations(params);
  setStations(stations);
} catch (error) {
  console.error('Failed to fetch stations:', error);
  // Fallback to cached data or show error message
}
```

### Common Issues

1. **CORS Errors** - Some stations don't support CORS
2. **404 Errors** - Stream URL no longer valid
3. **Network Errors** - Connection issues
4. **Missing Geo Data** - Filter with `has_geo=true`

---

## ‚ö° Performance Optimization

### 1. Memoization

```typescript
const validStations = useMemo(() => 
  stations.filter(s => s.geo_lat && s.geo_long),
  [stations]
);

const pointData = useMemo(() => 
  validStations.map(s => ({ ...s, lat: s.geo_lat })),
  [validStations, activeStation]
);
```

### 2. Lazy Loading

```typescript
// Load stations on demand
const loadMoreStations = async () => {
  const newStations = await radioApi.getTopVoted(limit);
  setStations(prev => [...prev, ...newStations]);
};
```

### 3. Debouncing Search

```typescript
const debouncedSearch = useMemo(
  () => debounce((query: string) => {
    onFilterChange({ name: query });
  }, 500),
  []
);
```

### 4. Image Optimization

```typescript
// Use favicon with fallback
<img 
  src={station.favicon} 
  onError={(e) => e.target.src = '/default-icon.png'}
  loading="lazy"
/>
```

---

## üß™ Testing Guidelines

### Unit Testing (Future)

```typescript
// Example test structure
describe('radioApi', () => {
  it('should fetch top voted stations', async () => {
    const stations = await radioApi.getTopVoted(10);
    expect(stations).toHaveLength(10);
    expect(stations[0]).toHaveProperty('stationuuid');
  });
});
```

### Manual Testing Checklist

- [ ] Globe renders correctly
- [ ] Stations appear on globe
- [ ] Click station to play
- [ ] Audio plays without errors
- [ ] Search functionality works
- [ ] AI recommendations work
- [ ] Favorites save to localStorage
- [ ] Responsive on mobile
- [ ] Error states display properly

---

## üö¢ Deployment

### Build for Production

```bash
npm run build
```

Output: `dist/` folder

### Deployment Platforms

1. **Vercel** (Recommended)
```bash
npm install -g vercel
vercel
```

2. **Netlify**
```bash
npm install -g netlify-cli
netlify deploy --prod
```

3. **GitHub Pages**
```bash
npm run build
# Deploy dist/ folder
```

### Environment Variables

Set in deployment platform:
```
GEMINI_API_KEY=your_production_key
```

---

## üîß Troubleshooting

### Issue: Audio not playing

**Possible Causes:**
1. CORS issues with stream URL
2. HTTPS/HTTP mixed content
3. Stream URL broken

**Solutions:**
```typescript
// Try HTTPS upgrade
streamUrl = streamUrl.replace('http:', 'https:');

// Add error handling
audio.onerror = () => {
  console.error('Stream failed, trying next station');
};
```

### Issue: Globe not rendering

**Check:**
1. Three.js loaded correctly
2. WebGL support in browser
3. Console for errors

### Issue: API requests failing

**Check:**
1. Network connectivity
2. API mirror status
3. CORS headers

---

## üìù Development Best Practices

### 1. Code Organization
- Keep components small and focused
- Use TypeScript for type safety
- Follow React hooks best practices

### 2. Performance
- Use `useMemo` for expensive calculations
- Implement virtual scrolling for large lists
- Optimize re-renders with `React.memo`

### 3. Accessibility
- Add ARIA labels
- Keyboard navigation support
- Screen reader friendly

### 4. Security
- Validate API responses
- Sanitize user inputs
- Use HTTPS for production

---

## üîÆ Future Enhancements

### Planned Features
- [ ] User accounts and cloud sync
- [ ] Playlist creation
- [ ] Social sharing
- [ ] Recording functionality
- [ ] Sleep timer
- [ ] Equalizer
- [ ] Offline mode
- [ ] PWA support

### API Improvements
- [ ] Implement caching layer
- [ ] Add retry logic
- [ ] Rate limiting
- [ ] Analytics tracking

---

## üìû Support & Resources

### Documentation
- [React Docs](https://react.dev/)
- [Vite Docs](https://vitejs.dev/)
- [Three.js Docs](https://threejs.org/docs/)
- [Tailwind CSS](https://tailwindcss.com/)

### Community
- Radio Browser GitLab: https://gitlab.com/radiobrowser/radio-database
- Radio Browser Users: https://www.radio-browser.info/users

---

## üìÑ License

This project uses:
- Radio Browser API (Community Database)
- Google Gemini AI (Requires API Key)
- Open Source Libraries (See package.json)

---

**Last Updated:** 2026-01-26  
**Version:** 1.0.0  
**Maintainer:** J Radio Development Team
